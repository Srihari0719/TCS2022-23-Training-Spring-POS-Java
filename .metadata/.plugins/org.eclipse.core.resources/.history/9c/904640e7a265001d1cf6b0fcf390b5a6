/**
 * 
 */
package com.tcs.dao;

import java.sql.*;
import java.util.Scanner;

import com.tcs.utils.DBUtils;

/**
 * @author Administrator
 *
 */
public class ProfessorDaoImp implements ProfessorDaoInterface{
	
	DBUtils cc = new DBUtils();
	Connection conn = null;
	PreparedStatement pr = null;
	Scanner sc = new Scanner(System.in);
	
	@Override
	public void addGrades(String username, String course) {
		// TODO Auto-generated method stub
		conn = cc.connect();
		String sql = "SELECT Id,name,courseId,courseName from Student s INNER JOIN CourseRegistration cr on s.Id=cr.studentId where cr.pName= (SELECT professorName from Professor where username = '" + username +"')";
		try {
			pr = conn.prepareStatement(sql);
			ResultSet rs = pr.executeQuery(sql);
			while(rs.next()) {
				System.out.println("Student ID : " + rs.getInt("Id")+"Student Name : " + rs.getString("name")+"Course Name : "+rs.getString("courseName"));
				System.out.println("Enter Grade(A+,A,B+,B,C,F,AB) : ");
				String grade = sc.nextLine();
				
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		try {
			conn.close();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

	@Override
	public void viewCourseEnrolledStudents(String username, String courseName) {
		// TODO Auto-generated method stub
		conn = cc.connect();
		String sql = "SELECT Id,name,courseName from Student s INNER JOIN CourseRegistration cr on s.Id=cr.studentId where cr.pName= (SELECT professorName from Professor where username = '" + username +"')";
		try {
			pr = conn.prepareStatement(sql);
			ResultSet rs = pr.executeQuery(sql);
			while(rs.next()) {
				System.out.println("Student ID : " + rs.getInt("Id")+"Student Name : " + rs.getString("name")+"Course Name : "+rs.getString("courseName"));
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		try {
			conn.close();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

}
